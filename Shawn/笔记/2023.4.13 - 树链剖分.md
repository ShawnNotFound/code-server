---
title: 树链剖分 | 学习笔记
date: 2023-04-13 21:03:16
categories: 算法
tags: 算法
author: Shawn
cover: https://img0.baidu.com/it/u=3252879737,2908887575&fm=253&fmt=auto&app=120&f=JPEG?w=1280&h=800
---
# 介绍
+ 给树中的每个节点重新编号，使得树中**任意一条路径**可以变成$O(\log n)$段**连续的区间**，可以将**树中路径问题**转化为**区间问题**
+ 转化为区间问题之后再使用线段树维护区间
# 基础概念
![image](https://oiwiki.com/graph/images/hld.png)
## 重儿子
+ 对于叶节点，不存在儿子也就不存在儿子的概念
+ 对于一个节点，求这个点**子节点**的**节点总数**，**节点个数最多**的**子树的根节点**就是其父节点的**重儿子**
+ 若有多个节点的节点数都是最大值，那么任取一个作为重儿子
  
## 轻儿子
+ 不是重儿子的点都是轻儿子

## 重边
+ 重儿子和他父节点之间的连边就是重边

## 轻边
+ 不是重边的边就是轻边

## 重链
+ **极大的**重边构成的链
+ 每个点都会在一个重链里面，最差也会在自己一个点构成的重链里面
# 实现
## 定理
+ 树中任意一条路径均可拆分成$O(\log n)$条重链，即可拆分成$O(\log n)$个连续区间
## 方法
1. 将一棵**树**转化为一个**序列**
2. 将树中**路径**转化成$\log n$段连续区间
3. `dfs`序遍历：在每次遍历的时候优先遍历重儿子
    >这样就可以保证所有重链的编号都是连续的

### 寻找两个点之间的最短路径
1. 寻找第一个点所在的重链的顶点，寻找第二个点所在的重链的顶点
2. 对比两个顶点，找出更靠下的点，走到这条重链的顶点
3. 将移动了的点变成重链顶点的父节点，继续循环第一二步
4. 最后二者一定会走到同一个重链上，此时这两点之间的一段也是结果的一部分